健壮性：防止由于单个用户报错导致后端炸掉

aop切面

session/cookie/token 异同







# AOP (面向切面编程)

## 1. 为什么要用 AOP？
AOP 的核心价值在于**关注点分离**。

* **场景假设**：如果项目有 100 个接口，需要统一加上“记录日志”和“校验登录”功能。
* **不用 AOP**：必须在 100 个方法里重复写相同的代码，导致代码臃肿、难以维护。
* **使用 AOP**：只需编写一个“切面类”，声明拦截规则。这 100 个方法会自动获得功能，而业务逻辑代码保持纯净。

---

## 2. AOP 核心概念

| 术语                    | 解释                                       | 比喻                   |
| :---------------------- | :----------------------------------------- | :--------------------- |
| **Aspect (切面)**       | 存放通用功能（如日志、权限）的类。         | **警察局**（职能部门） |
| **Join Point (连接点)** | 程序执行中可以插入切面的点（通常是方法）。 | **路口**               |
| **Pointcut (切入点)**   | 匹配规则，决定切面在哪些方法上生效。       | **红绿灯设置点**       |
| **Advice (通知)**       | 切面执行的具体时机（前、后、环绕）。       | **出警动作**           |

### 通知 (Advice) 的类型：
1.  **Before**：目标方法执行前。
2.  **After**：目标方法执行后（不论成功或失败）。
3.  **Around (环绕)**：**最常用**。可以手动控制目标方法是否执行，并修改返回值。

---

## 3. 实现原理：动态代理
Spring AOP 的底层主要依靠代理模式：

* **JDK 动态代理**：目标类**实现了接口**时使用。通过实现相同接口来创建代理对象。
* **CGLIB 代理**：目标类**未实现接口**时使用。通过修改字节码生成目标类的子类来做代理。

